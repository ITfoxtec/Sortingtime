(function(){"use strict";function n(){return{restrict:"E",transclude:!0,require:["ngModel"],scope:{model:"=ngModel",groupTaskForm:"=",selectItems:"&",createActiveSave:"&"},template:'<div class="create-dropdown" uib-dropdown is-open="isOpen"><div ng-transclude><\/div><ul ng-if="isOpen" class="dropdown-menu option" uib-dropdown-menu style="width: 100%" role="menu" ng-click="stopClick($event)"><li><div class="row form-group"><div class="col-xs-12 text-right"><button type="submit" class="btn btn-default btn-sm btn-primary" ng-if="showText(\'g\', \'n\')" ng-click="::save($event)" translate-once="GENERAL.CREATE_DROPDOWN.CREATE_GROUP"><\/button><button type="submit" class="btn btn-default btn-sm btn-primary" ng-if="showText(\'g\')" ng-click="::save($event)" translate-once="GENERAL.CREATE_DROPDOWN.CHANGE_GROUP"><\/button><button type="submit" class="btn btn-default btn-sm btn-primary" ng-if="showText(\'t\', \'n\')" ng-click="::save($event)" translate-once="GENERAL.CREATE_DROPDOWN.CREATE_TASK"><\/button><button type="submit" class="btn btn-default btn-sm btn-primary" ng-if="showText(\'t\')" ng-click="::save($event)" translate-once="GENERAL.CREATE_DROPDOWN.CHANGE_TASK"><\/button><button type="submit" class="btn btn-default btn-sm" ng-click="::cancel($event)" translate-once="GENERAL.BUTTONS.CANCEL"><\/button><\/div><\/div><\/li><li ng-if="listItems && listItems.length > 0"><div class="row form-group"><div class="col-xs-12"><small class="left-space" ng-if="showText(\'g\', \'s\')" translate-once="GENERAL.CREATE_DROPDOWN.SELECT_GROUP"><\/small><small class="left-space" ng-if="showText(\'t\', \'s\')" translate-once="GENERAL.CREATE_DROPDOWN.SELECT_TASK"><\/small><\/div><\/div><\/li><li role="menuitem" ng-repeat="item in listItems track by item.id"><a class="btn btn-default btn-sm btn-select" ng-click="::selectValue($event, item)">{{item.value}}<\/a><\/li><\/ul><\/div>',controller:function(n){var t=!1;this.open=function(){t&&console.log("groupTaskDropdown; open");n.isOpen||(n.isOpen=!0,n.createActiveSave()(null,null,{item:n.model,form:n.groupTaskForm},null,null,"open"),n.doBackup(),n.selectItems()(n.model.name,n.model,n.updateItems),n.bindEvents(),n.isCreating()&&!n.groupTaskForm.pristine&&n.groupTaskForm.$setPristine())};this.save=function(){t&&console.log("groupTaskDropdown; save");n.saveInternal()};this.cancel=function(){t&&console.log("groupTaskDropdown; cancel");n.isOpen=!1}},link:function(n,t,i,r){var f=r[0],c=!1,u=!1,e=!1,h=null,o,s;n.listItems={};n.bindEvents=function(){u&&console.log("groupTaskDropdown; bindEvents");c||(c=!0,n.$watch("model.name",function(t){u&&console.log("groupTaskDropdown; watch model.name value: "+t);n.isOpen&&n.selectItems()(n.model.name,n.model,n.updateItems)}),n.$watch("isOpen",function(t){u&&console.log("groupTaskDropdown; watch isOpen, value: "+t);t===!1&&(n.isCreating()?n.createActiveSave()(null,null,{item:n.model,form:n.groupTaskForm},null,!0):e&&n.model.name!==h&&(n.model.name=h))}))};n.doBackup=function(){u&&console.log("groupTaskDropdown; doBackup");e||(u&&console.log("groupTaskDropdown; doBackup model.name, initValueBackup value: "+n.model.name),h=angular.copy(n.model.name),e=!0)};n.isCreating=function(){return u&&console.log("groupTaskDropdown; isCreating"),n.model.state!==undefined};n.showText=function(t,i){return u&&console.log("groupTaskDropdown; showText"),n.model.type===t&&(i==="s"||n.model.state===i)};n.selectValue=function(t,i){u&&console.log("groupTaskDropdown; selectValue item.id: "+i.id);t.preventDefault();t.stopPropagation();n.createActiveSave()(o,s,{item:n.model,form:n.groupTaskForm},i)};n.updateItems=function(t){u&&console.log("groupTaskDropdown; updateItems newcreateItems: "+t);n.listItems=angular.copy(t)};n.save=function(t){u&&console.log("groupTaskDropdown; save");t.preventDefault();t.stopPropagation();n.createActiveSave()(o,s,{item:n.model,form:n.groupTaskForm})};n.saveInternal=function(){n.createActiveSave()(o,s,{item:n.model,form:n.groupTaskForm})};n.cancel=function(t){u&&console.log("groupTaskDropdown; cancel");t.preventDefault();n.isOpen=!1};n.stopClick=function(n){u&&console.log("createDropdown; stopClick");n.preventDefault();n.stopPropagation()};f.setServerErrorValidity=function(n,t){f.serverError=n?"":t.join?t.join(", "):t;f.$setValidity("serverError",n)};o=function(){u&&console.log("groupTaskDropdown; activeSaveSuccessCallBack");e=!1;n.isOpen=!1};s=function(n,t){if(u&&console.log("groupTaskDropdown; activeSaveErrorCallBack"),!t&&n&&n.data&&angular.isObject(n.data))for(var i in n.data){f.setServerErrorValidity(!1,n.data[i]);n.isHandled=!0;break}else notificationFactory.error(n)}}}}angular.module("app").directive("groupTaskDropdown",n)})();